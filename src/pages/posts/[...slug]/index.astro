---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog", ({ data }) => !data.draft && data.lang === "ko");

  return posts.map(post => {
    // Extract slug from id (e.g., "ko/netzmq-memory-optimization-ko" -> "netzmq-memory-optimization-ko")
    const slug = post.id.split('/').pop() || post.id;
    return {
      params: { slug },
      props: { slug },
    };
  });
}

const { slug } = Astro.props;
const redirectUrl = `/ko/posts/${slug}`;
---

<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="refresh" content="0; url={redirectUrl}" />
    <link rel="canonical" href={redirectUrl} />
    <title>Redirecting...</title>
  </head>
  <body>
    <p>Redirecting to <a href={redirectUrl}>{redirectUrl}</a>...</p>
  </body>
</html>
